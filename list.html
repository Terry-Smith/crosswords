<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width">
	<meta name="description" content="Download and play crossword puzzles from various place on the internet.">
	<link rel="icon" href="windows11/Square44x44Logo.altform-unplated_targetsize-16.png" type="image/png">
	<link rel="manifest" href="manifest.json" />
	
	<title>Crosswords - Download and play crossword puzzles</title>
	
	<style>
		@view-transition {
			navigation: auto;
		}

		html {
			background-color: #325891;
			font-family: sans-serif;
			font-size: 12pt;
		}

		body {
			margin: 0px;
			padding: 0px;
			background-color: #FBFBFB;
			height: calc(100vh - 3.5rem);
			user-select: none;
			overflow: hidden;
		}

		main {
			flex: 1 1 auto;
			overflow: hidden;
		}

		header, footer {
			flex: 0 0 auto;
		}
		footer {
			border-top-style: solid;
			border-top-width: 1px;
			border-top-color: lightgray;
			padding: 0.5rem;
			display: inline-grid;
			grid-template-columns: repeat(10, 1fr);
			font-size: 1.25rem;
			background-color: white;
			color: black;
			cursor: default;
			width: min-content;
		}

		.client-area {
			display: flex;
			height: 100%;
			flex-direction: column;
		}

		.puzzle-header {
			background-color: #5d5d5d;
			color: white;
			z-index: 1;
			display: flex;
			flex-direction: row;
			align-items: center;
			flex-wrap: nowrap;
			justify-content: space-between;
		}
		
		.puzzle-clue {
			padding: 1rem;
			padding-top: 1.5rem;
			padding-bottom: 1.5rem;
			max-height: 3rem;
			flex-grow: 1;
		}

		.puzzle-button {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			font-size: 1.5rem;
			color: white;
			background-color: transparent;
			border: none;
			margin-left: .5rem;
			margin-right: .5rem;
			border-radius: 1.5rem;
			height: 2rem;
			width: 2rem;
			padding: 0;
		}
		
		.puzzle-button:hover {
			background-color: rgb(255 255 255 / 28%);
		}

		.puzzle-button:focus {
			background-color: rgb(255 255 255 / 28%);
		}
		
		@media (min-resolution: 150dpi) {
			.puzzle-clue {
				font-size: 1.25rem;
			}
		}

		.puzzle-content {
			padding: 0;
			overflow: auto;
			position: relative;
		}
		
		.puzzle-grid {
			display: inline-grid;
			grid-template-columns: repeat(var(--puzzle-size), 1fr);
			grid-column-gap: 1px;
			grid-row-gap: 1px;
			background-color: black;
			border-style: solid;
			border-width: 1px;
		}

		.puzzle-cell {
			display: inline-grid;
			font-size: 1.5rem;
			width: 2rem;
			height: 2rem;
			color: black;
			background-color: white;
			padding: .1rem;
			justify-content: center;
			align-content: center;
			user-select: none;
		}

		@media (min-resolution: 150dpi) {
			.puzzle-cell {
				font-size: 2.25rem;
				width: 3.5rem;
				height: 3.5rem;
			}
		}
		
		.puzzle-cell-sample {
			font-size: 0.5rem;
			width: 1rem;
			height: 1rem;
			border-style: solid;
			border-width: 1px;
			margin-left: 3rem;
		}

		.puzzle-cell-current-clue {
			background-color: #F3B169;
		}

		.puzzle-cell-current-clue[guess="wrong"] {
			color: red;
		}
		
		.puzzle-cell-block {
			background-color: black;
		}
		
		.puzzle-cell-focus {
			background-color: #DD6A2A;
		}

		.puzzle-cell-focus[guess="wrong"] {
			color: #FFFFFF;
		}

		.puzzle-cell:not(.puzzle-cell-current-clue)[guess="waswrong"] {
			background-color: #FEDEDE;
		}

		.puzzle-cell:not(.puzzle-cell-current-clue)[guess="wrong"] {
			background-color: red;
		}
		
		.puzzle-cell::before {
			content: attr(cluenumber);
			display: inline-block;
			font-size: .5rem;
			position: absolute;
			color: initial;
		}

		@media (min-resolution: 150dpi) {
			.puzzle-cell::before {
				font-size: 1rem;
			}
		}
		
		.puzzle-cell-sample:before {
			font-size: 0.5rem;
		}

		.puzzle-keyboard-key {
			display: inline-grid;
			font-size: 1.75rem;
			width: 2.2rem;
			height: 3.1rem;
			justify-content: center;
			align-content: center;
			user-select: none;
			margin-bottom: 0.55rem;
			margin-right: 0.3rem;
			background-color: white;
			border-radius: .5rem;
		}

/*		@media (min-resolution: 150dpi) {
			.puzzle-keyboard-key {
				font-size: 2.5rem;
				width: 4rem;
				height: 4rem;
			}
		}
*/		
		.puzzle-keyboard-key:hover {
			outline: none;
			box-shadow: inset 0 0 0 0.2rem rgba(38,143,255,.5);
		}

		.puzzle-keyboard-key[key-action="bs"] {
			background-color: #d9d9d9;
			width: 3rem;
		}
		
		dialog {
			padding: 1rem;
			border-style: none;
			border-radius: 1rem;
			min-height: 10rem;
			min-width: 15rem;
			font-size: .90rem;
			max-height: calc(100vh - 3rem);
			max-width: calc(100vw - 3rem);
			top: -12rem;
			padding-top: .5rem;
			box-shadow: 0 0 13px 0.25rem rgb(67 67 67 / 50%);
		}

		.dlg-title {
			border-bottom-style: solid;
			border-bottom-width: 1px;
			border-bottom-color: lightgray;
			padding-bottom: .5rem;
			padding-top: .5rem;
			text-align: center;
		}
		
		.dlg-title h1 {
			margin: 0;
		}
		
		.close-btn {
			border: solid;
			background-color: transparent;
			font-size: 1rem;
			border-width: 1px;
			padding: .25rem;
			border-color: lightgray;
			padding-left: .5rem;
			padding-right: .5rem;
		}
		
		.close-btn:hover {
			background-color: lightgray;
		}
		
		.dlg-row {
			display: flex;
			align-items: center;
			padding-top: .5rem;
			padding-bottom: .5rem;
			flex-wrap: wrap;
		}
		
		.dlg-row-space-between {
			justify-content: space-between;
		}

		.dlg-row-justify-left {
			justify-content: flex-start;
			display: flex;
			flex-direction: column;
			align-items: flex-start;
			align-content: flex-start;
		}
		
		.dlg-row-justify-right {
			justify-content: flex-end;
		}
		
		.dlg-row select {
			margin-top: .25rem;
		}
		
		.dlg-row-description {
			font-size: 75%;
			color: #615e5e;
			letter-spacing: .02rem;
			margin-top: .25rem;
		}
		
		.dlg-footer {
			text-align: center;
			border-top-style: solid;
			border-top-color: lightgray;
			border-top-width: 1px;
			padding-top: 1rem;
			margin-top: .5rem;
		}
		
		@media (min-resolution: 150dpi) {
			.dlg-row {
				font-size: 1.5rem;
			}
			.dlg-row-description {
				font-size: 50%;
			}
			.dlg-row select {
				font-size: 1.25rem;
			}
		}
		
		.checkbox-label {
			display: flex;
			flex-direction: row;
			align-items: center;
		}
		
		.checkbox-label > input {
			margin-right: 0.5rem;
		}

	</style>

	<script src="https://cdn.jsdelivr.net/npm/idb@8/build/umd.js"></script>
	<script>
		function htmlEncode(text) {
			if (text !== undefined && text !== null && typeof text === "string") {
				return text.replace(/&/g, "&amp;")
						   .replace(/</g, "&lt;")
						   .replace(/>/g, "&gt;")
						   .replace(/"/g, "&quot;")
						   .replace(/'/g, "&#39;");
			} else {
				return text;
			}
		}

		let crosswordsDb;
		async function initCrosswordsDb() {
			crosswordsDb = await idb.openDB("crosswords", 1, {
				upgrade(db, oldVersion, newVersion, transaction, event) {
					const settingsStore = db.createObjectStore("settings", { keyPath: "id" });
					const puzzleStore = db.createObjectStore("puzzles", { keyPath: ["date", "source", "title"] });
					const playedPuzzlesStore = db.createObjectStore("playedPuzzles", { keyPath: ["date", "source", "title"] });
				},
				blocked(currentVersion, blockedVersion, event) {
					console.log("initCrosswordsDb - blocked");
				},
				blocking(currentVersion, blockedVersion, event) {
					console.log("initCrosswordsDb - blocking");
				},
				terminated() {
					console.log("initCrosswordsDb - terminated");
				},
			});
		}
		
		async function saveSettings(co) {
			await crosswordsDb.put("settings", co);
		}
		
		async function saveState(ps) {
			await crosswordsDb.put("playedPuzzles", ps);
		}

		async function getState(pd) {
			return await crosswordsDb.get("playedPuzzles", [pd.date, pd.source, pd.title]);
		}
		
		async function getPuzzles() {
			const puzzles = [];
			const tx = crosswordsDb.transaction("puzzles");
			for await (const cursor of tx.store) {
				puzzles.push(cursor.value);
			}
			return puzzles;
		}
		
		async function getPuzzle(puzzleKey) {
			return await crosswordsDb.get("puzzles", [puzzleKey.date, puzzleKey.source, puzzleKey.title]);
		}

		let defaultCrosswordOptions = {
			id: "me",
			showErrors: false,
			skipFilledCells: false,
			movementStyle: "stopAtEnd",
			useNativeKeyboard: false,
			puzzleScale: 1,
			puzzleKey: ""
		};

		let currentPuzzle;
		let defaultPuzzleState = {
			direction: "across", // across or down
			currentCellIndex: 0
		}
		let crosswordOptions;
		let puzzleDefinition;
		let puzzleState;

		function getTargetAction(targetEl) {
			let action;
			while (targetEl !== undefined && targetEl !== null) {
				action = targetEl.getAttribute("action");
				if (action !== undefined && action !== null) {
					break;
				}
				targetEl = targetEl.parentElement;
			}
			return {targetEl: targetEl, action: action};
		}

		function padDate(num) {
			if (num < 10) {
				return `0${num}`;
			}
			return `${num}`;
		}

		function formatGroupHeader(data) {
			return `<li class="group-header" data-group-value="${data.date}">
	<div>${data.dateFormatted}</div>
</li>`;
		}
		
		function formatListEntry (data) {
			let listPrefix = "&#9654;";
			let prefixColor = "--gray-color";
			let layer1Css = "";
			let layer2Css = "";
			let complete = "";
			if (data.percentComplete > 0) {
				listPrefix = `${data.percentComplete}%`;
				layer1Css = " circle";
				layer2Css = " circle arc";
				if (data.percentComplete === 100) {
					listPrefix = "&#x2714;"
					prefixColor = "--green-color";
					complete = "complete";
				} else {
					prefixColor = "--mustard-color";
				}
			}
			return `<li class="list-item" data-date="${htmlEncode(data.date)}" data-source="${htmlEncode(data.source)}" data-title="${htmlEncode(data.title)}" style="--prefix-color: var(${prefixColor})" tabindex="0" action="playPuzzle" ${data?.selected ? "selected":""}>
	<div class="list-prefix list-prefix-layer${layer1Css}"></div>
	<div class="list-prefix list-prefix-layer${layer2Css}" style="--degrees: ${((data.percentComplete / 100.0).toFixed(2))*360}deg;"></div>
	<div class="list-prefix"${complete}>
		${listPrefix}
	</div>
	<div class="list-data">
		<div>
			<div class="source">${data.source}</div>
			<div class="description">${data.title}</div>
			<div class="note">${data.trustedNotes}</div>
		</div>
	</div>
</li>`;
		}

		const pickerDateFormat = new Intl.DateTimeFormat(undefined,{weekday: "short", month: "short", day: "numeric"});

		const dlgInitFunctions = {
			"download-puzzles-init": function(dialogEl) {
				const dateEl = dialogEl.querySelector("#DownloadDate");
				const dateBannerEl = dialogEl.querySelector("[class~='date-banner']");
				const dateBannerDateEl = dialogEl.querySelector("[class~='date-banner-date']");
				const dateBannerYearEl = dialogEl.querySelector("[class~='date-banner-year']");
				
				function updateDateBanner() {
					if (dateEl !== undefined && dateEl !== null) {
						let selectedDate;
						if (dateEl.value === undefined || dateEl.value === null || dateEl.value.trim() === "") {
							selectedDate = new Date();
							dateEl.value = `${selectedDate.getFullYear()}-${padDate(selectedDate.getMonth()+1)}-${padDate(selectedDate.getDate())}`;
						} else {
							selectedDate = new Date(dateEl.value + " 00:00:00");
						}
						
						if (dateBannerDateEl !== undefined && dateBannerDateEl !== null) {
							// Need a time with the date to get the correct time zone.
							dateBannerDateEl.innerText = pickerDateFormat.format(selectedDate);
						}
						if (dateBannerYearEl !== undefined && dateBannerYearEl !== null) {
							dateBannerYearEl.innerText = selectedDate.getFullYear();
						}
					}
				}
				
				if (!dialogEl.inited) {
					dialogEl.inited = true;
					const downloadBtnEl = dialogEl.querySelector("[action='download-puzzles']");
					if (downloadBtnEl !== undefined && downloadBtnEl !== null) {
						downloadBtnEl.addEventListener("click", async function(e) {
							const response = await fetch(`https://bright-rat-90.deno.dev/?date=${dateEl.value}`);
							if (response.ok) {
								const jsonData = await response.json();
								
								for (const puz of jsonData) {
									if (puz.success) {
										await crosswordsDb.put("puzzles", puz.data);
									} else {
										console.log(`There was a problem downloading a puzzle: ${puz.message}`);
									}
								}
								await displayPuzzleList();
							}

							dialogEl.close();
						});
					}
					dateEl.addEventListener("change", function(e) {
						updateDateBanner();
					});
					
					dateBannerEl.addEventListener("click", function(e) {
						dateEl.showPicker();
					});					
				}

				updateDateBanner();
			}
		};

		function selectListItem(listItemEl) {
			const selEl = listItemEl.parentElement.querySelector("li[selected]");
			if (selEl !== undefined && selEl !== null && selEl !== listItemEl) {
				selEl.removeAttribute("selected");
			}
			listItemEl.setAttribute("selected", "");
		}

		function computePercentComplete(guesses, answers) {
			let total = 0;
			let correct = 0;
			for (let i = 0; i < guesses.length; i++) {
				if (answers[i] !== "#") {
					total++;
					if (answers[i] === guesses[i].letter) {
						correct++;
					}
				}
			}
			return Math.floor((correct / total) * 100.0);
		}

		async function displayPuzzleList() {
			let allPuzzleDefinitions = await getPuzzles();
			
			if (allPuzzleDefinitions.length === 0) {
				const el = document.querySelector("[class~='download-hint']");
				if (el !== undefined && el !== null) {
					el.classList.remove("hidden");
				}
			}
			
			const groupDateFormat = new Intl.DateTimeFormat(undefined,{weekday: "short", month: "short", day: "numeric", year: "numeric"});
			function formatGroupDate (date) {
				let formattedDate = "";
				const parts = groupDateFormat.formatToParts(date);
				let previousPartType = "";
				for (const part of parts) {
					let val = part.value;
					if (part.type === "literal" && previousPartType == "weekday") {
						val = " ";
					} 
					previousPartType = part.type;
					formattedDate = formattedDate + val;
				}
				return formattedDate;
			}

			let puzzleKey;
			const puzzleKeyJson = crosswordOptions?.puzzleKeyJson;
			if (puzzleKeyJson !== null && puzzleKeyJson !== undefined && puzzleKeyJson.length > 0) {
				puzzleKey = JSON.parse(puzzleKeyJson);
			}
			
			let html = "";
			let curDate = "";
			for (const puz of allPuzzleDefinitions) {
				if (curDate != puz.date) {
					curDate = puz.date;
					const groupDate = new Date(puz.date + " 00:00:00");
					html = html + formatGroupHeader({date: curDate, dateFormatted: formatGroupDate(groupDate)});
				}
				
				const ps = await getState(puz);
				let percentComplete = 0;
				if (ps !== undefined && ps !== null) {
					percentComplete = computePercentComplete(ps.cellGuesses, puz.cellContent);
				}

				const data = {
					percentComplete: percentComplete,
					date: puz.date,
					source: puz.source,
					title: puz.title,
					trustedNotes: puz.trustedNotes,
					selected: (puzzleKey?.date === puz.date && puzzleKey?.source === puz.source && puzzleKey?.title === puz.title)
				}

				html = html + formatListEntry(data);
			}

			let el = document.querySelector("ul[class='puzzle-list']");
			if (el !== undefined && el !== null) {
				el.innerHTML = html;
			}
		}
		
		window.addEventListener("load", async function(e) {

			document.addEventListener("click", function(e) {
				let targetEl;
				let action;
				({ targetEl: targetEl, action: action } = getTargetAction(e.target));
				if (action !== null && action !== undefined) {
					let m = /^show-dialog-(?<button>.*)$/.exec(action);
					if (m !== undefined && m !== null) {
						const dlgName = m.groups["button"];
						let dialogEl = document.querySelector("#"+dlgName);
						if (dialogEl !== undefined && dialogEl !== null) {
							const initFn = dlgInitFunctions[dlgName+"-init"];
							if (initFn !== undefined && initFn !== null) {
								initFn(dialogEl);
							}
							dialogEl.showModal();
						}
					} else if (action === "close-dlg") {
						let dialogEl = targetEl;
						while (dialogEl !== undefined && dialogEl !== null) {
							if (dialogEl.nodeName === "DIALOG") {
								dialogEl.close();
								break;
							}
							dialogEl = dialogEl.parentElement;
						}
					} else if (action === "playPuzzle") {
						selectListItem(targetEl);
						const puzzleKey = {
							date: targetEl.dataset.date,
							source: targetEl.dataset.source,
							title: targetEl.dataset.title
						}
						crosswordOptions.puzzleKeyJson = JSON.stringify(puzzleKey);
						saveSettings(crosswordOptions);
						window.location.href = "board.html";
					}
				}
			});

			await initCrosswordsDb();
			
			await displayPuzzleList();
			
			crosswordOptions = await crosswordsDb.get("settings", "me");
			if (crosswordOptions === undefined || crosswordOptions === null) {
				crosswordOptions = structuredClone(defaultCrosswordOptions);
				saveSettings(crosswordOptions);
			} else {
				if (crosswordOptions.advanceToNextClueAtEndOfWord !== undefined) {
					crosswordOptions.movementStyle = "stopAtEnd";
					crosswordOptions.advanceToNextClueAtEndOfWord = undefined;
					if (crosswordOptions.puzzleKeyJson === undefined || crosswordOptions.puzzleKeyJson === null) {
						crosswordOptions.puzzleKeyJson = "";
					}
				}
			}
		});
		
		async function updateCurrentListItem() {
			const puzzleKeyJson = crosswordOptions?.puzzleKeyJson;
			if (puzzleKeyJson !== null && puzzleKeyJson !== undefined && puzzleKeyJson.length > 0) {
				const puzzleKey = JSON.parse(puzzleKeyJson);
				
				const el = document.querySelector(`li[class="list-item"][data-date="${puzzleKey.date}"][data-source="${puzzleKey.source}"][data-title="${puzzleKey.title.replaceAll("\"", "\\\"")}"]`);
				if (el !== undefined && el !== null) {
					const puzzleDefinition = await getPuzzle(puzzleKey);
					
					const ps = await getState(puzzleDefinition);
					let percentComplete = 0;
					if (ps !== undefined && ps !== null) {
						percentComplete = computePercentComplete(ps.cellGuesses, puzzleDefinition.cellContent);
					}

					const data = {
						percentComplete: percentComplete,
						date: puzzleDefinition.date,
						source: puzzleDefinition.source,
						title: puzzleDefinition.title,
						trustedNotes: puzzleDefinition.trustedNotes
					}
					const html = formatListEntry(data);
					el.innerHTML = html;
					
					selectListItem(el);
				}
			}
		}
		
		window.addEventListener("pageshow", updateCurrentListItem);
		
		</script>

	<style>
	:root {
		--mustard-color: #CDA73D;
		--gray-color: #B4B4B4;
		--green-color: #4E8F5F;
		--hint-background-color: #e9e9e9;
	}

	html {
		letter-spacing: 0.02rem;
	}

	.grid-layout {
		display: grid;
		grid-template-rows: auto 1fr auto;
		max-height: calc(100vh - 3.5rem);
	}

	.page-header {
		grid-row: 1;
		background-color: lightblue;
		background-color: #5d5d5d;
		color: white;
		z-index: 1;
		display: flex;
		flex-direction: row;
		align-items: center;
		flex-wrap: nowrap;
		justify-content: space-between;
	}

	.page-content {
		background-color: lightyellow;
		position: relative;
		grid-row: 2;
		overflow: auto;
	}

	.scrollable-content {
		position: absolute;
	}

	.page-footer {
		grid-row: 3;
		border-top-style: solid;
		border-top-width: 1px;
		border-top-color: lightgray;
		padding: 0.5rem;
		padding-bottom: 0;
		display: inline-grid;
		grid-template-columns: repeat(10, 1fr);
		font-size: 1.25rem;
		background-color: #f1f1f1;
		color: black;
		cursor: default;
		width: min-content;
	}

	.puzzle-list {
		background-color: white;
		margin: 0;
		padding: 0;
		list-style: none;
	}
	
	.group-header {
		padding: 0.5rem;
		padding-left: 0.75rem;
		background-color: #cccccc;
		height: 2rem;
		display: grid;
		align-content: center;
	}

	.list-item {
/*		view-transition-name: puzzleTitle;*/
		display: flex;
		align-content: center;
		align-items: center;
		padding-top: .75rem;
		padding-bottom: .75rem;
		border-left-width: .2rem;
		border-left-style: solid;
		border-left-color: transparent;	
	}
	
	.list-item[selected] {
		border-left-color: green;
	}
	
	.list-item:hover {
		background-color: #f3f3f3;
	}
	
	.list-prefix {
		display: inline-flex;
		color: var(--prefix-color);
		height: 3.25rem;
		width: 3.25rem;
		align-items: center;
		justify-content: center;
		margin-left: 0.5rem;
		margin-right: 0.5rem;
	}
	
	.list-prefix[complete] {
		font-size: 1.5rem;
	}
	
	.list-prefix-layer {
		position: absolute;
	}
	
	.circle {
		aspect-ratio: 1;
		padding: 2px;
		box-sizing: border-box;
		border-radius: 50%;
		background: var(--prefix-color);
		mask:
			linear-gradient(#0000 0 0) content-box intersect,
			conic-gradient(#000 360deg,#0000 0);
	}
	
	@property --degrees {
		syntax: "<angle>";
		inherits: false;
		initial-value: 0deg;
	}
	
	.arc {
		padding: 7px; /* the border thickness */
		mask:
			linear-gradient(#0000 0 0) content-box intersect,
			conic-gradient(#000 var(--degrees),#0000 0);
	}

	.list-data {
		flex-grow: 1;
		padding-left: .25rem;
	}
	
	.source {
		font-size: 1.6rem;
	}
	
	.description {
		color: #595959;
		margin-top: .25rem;
		font-size: .9rem;
	}
	
	.note {
		font-size: 0.7rem;
		margin-top: 0.25rem;
		margin-bottom: 0.25rem;
		color: #bebebe;
		display: none;
	}
	
	#DownloadDate {
		font-size: 1rem;
		visibility: hidden;
		margin-top: -2rem;
	}
	
	.date-banner {
		font-size: 1.75rem;
		padding: .75rem;
		background-color: #88511D;
		color: #ffffff;
		margin-bottom: 0.5rem;
		width: 14rem;
	}
	
	.date-banner:active {
		padding-top: calc(.75rem + 2px);
		padding-left: calc(.75rem + 2px);
		padding-right: calc(.75rem - 2px);
		padding-bottom: calc(.75rem - 2px);
	}
	
	.date-banner:hover {
	}
	
	.date-banner-year {
		font-size: 1rem;
		margin-bottom: 0.10rem;
	}
	
	.inline-block {
		display: inline-block;
	}
	
	.background-color-header {
		background-color: #5d5d5d;
	}
	
	.download-hint {
		border-style: solid;
		border-width: 1px;
		border-color: var(--hint-background-color);
		padding: .5rem;
		margin: .5rem;
		border-radius: .25rem;
		background-color: var(--hint-background-color);
		width: 10rem;
		position: fixed;
		top: 50px;
		z-index: 1991;
		font-size: .9rem;
		box-shadow: 0px 0px 5px 2px #777575;
	}
	
	.box-arrow {
		position: absolute;
		border-style: solid;
		border-width: 1px;
		width: .75rem;
		height: .75rem;
		transform: rotate(45deg);
		border-right-style: none;
		border-top-style: none;
		border-color: transparent;
	}

	.box-arrow-top {
		top: calc((0.35rem + 1px) * -1);
		border-left-style: none;
		border-bottom-style: none;
		background-color: var(--hint-background-color);
		box-shadow: -2px -2px 2px 0px #777575;
	}

	.hidden {
		display: none;
	}
	</style>
</head>
<body>
	<div class="grid-layout">
		<div class="page-header">
			<button class="puzzle-button" aria-label="Download puzzles" action="show-dialog-download-puzzles">
				<svg viewBox="2 2 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
					<path d="m0 0h20v20h-20z" fill="currentColor" opacity="0"/>
					<g fill="currentColor">
						<rect height="2" rx="1" width="16" x="4" y="18"/>
						<rect height="2" rx="1" transform="matrix(0 -1 1 0 -13 23)" width="4" x="3" y="17"/>
						<rect height="2" rx="1" transform="matrix(0 -1 1 0 1 37)" width="4" x="17" y="17"/>
						<path d="m12 15a1 1 0 0 1 -.58-.18l-4-2.82a1 1 0 0 1 -.24-1.39 1 1 0 0 1 1.4-.24l3.42 2.39 3.4-2.56a1 1 0 0 1 1.2 1.6l-4 3a1 1 0 0 1 -.6.2z"/>
						<path d="m12 13a1 1 0 0 1 -1-1v-8a1 1 0 0 1 2 0v8a1 1 0 0 1 -1 1z"/>
					</g>
				</svg>
			</button>
			<div class="puzzle-clue">Puzzles</div>
			<button class="puzzle-button" aria-label="Show puzzle settings" action="show-dialog-puzzle-settings">
				<svg class="" fill="currentColor" aria-hidden="true" width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
					<path d="M13.85 22.25h-3.7c-.74 0-1.36-.54-1.45-1.27l-.27-1.89c-.27-.14-.53-.29-.79-.46l-1.8.72c-.7.26-1.47-.03-1.81-.65L2.2 15.53c-.35-.66-.2-1.44.36-1.88l1.53-1.19c-.01-.15-.02-.3-.02-.46 0-.15.01-.31.02-.46l-1.52-1.19c-.59-.45-.74-1.26-.37-1.88l1.85-3.19c.34-.62 1.11-.9 1.79-.63l1.81.73c.26-.17.52-.32.78-.46l.27-1.91c.09-.7.71-1.25 1.44-1.25h3.7c.74 0 1.36.54 1.45 1.27l.27 1.89c.27.14.53.29.79.46l1.8-.72c.71-.26 1.48.03 1.82.65l1.84 3.18c.36.66.2 1.44-.36 1.88l-1.52 1.19c.01.15.02.3.02.46s-.01.31-.02.46l1.52 1.19c.56.45.72 1.23.37 1.86l-1.86 3.22c-.34.62-1.11.9-1.8.63l-1.8-.72c-.26.17-.52.32-.78.46l-.27 1.91c-.1.68-.72 1.22-1.46 1.22zm-3.23-2h2.76l.37-2.55.53-.22c.44-.18.88-.44 1.34-.78l.45-.34 2.38.96 1.38-2.4-2.03-1.58.07-.56c.03-.26.06-.51.06-.78s-.03-.53-.06-.78l-.07-.56 2.03-1.58-1.39-2.4-2.39.96-.45-.35c-.42-.32-.87-.58-1.33-.77l-.52-.22-.37-2.55h-2.76l-.37 2.55-.53.21c-.44.19-.88.44-1.34.79l-.45.33-2.38-.95-1.39 2.39 2.03 1.58-.07.56a7 7 0 0 0-.06.79c0 .26.02.53.06.78l.07.56-2.03 1.58 1.38 2.4 2.39-.96.45.35c.43.33.86.58 1.33.77l.53.22.38 2.55z"></path><circle cx="12" cy="12" r="3.5"></circle>
				</svg>
			</button>
		</div>
		<div class="page-content">
			<ul class="puzzle-list">
			</ul>
			<div class="inline-block download-hint hidden">
				<div class="box-arrow box-arrow-top"></div>
				<div class="inline-block">
					<div style="display:flex; align-items:center">Click on the the download icon to start solving crossword puzzles.</div>
				</div>
			</div>
		</div>
	</div>

	<dialog id="download-puzzles">
		<div class="dlg-title">
			<h1>Download</h1>
		</div>
		<div class="dlg-row dlg-row-justify-left">
			<div class="date-banner">
				<div class="date-banner-year"></div>
				<div class="date-banner-date"></div>
			</div>
			<input name="downloadDate" id="DownloadDate" data-prop-name="downloadDate" type="date" >
			<div class="dlg-row-description">Download puzzles for the selected date.</div>
		</div>
		<div class="dlg-row dlg-row-justify-right">
			<button class="" action="download-puzzles">Download puzzles</button>
		</div>
		<div class="dlg-footer">
			<button class="close-btn" action="close-dlg">Close</button>
		</div>
	</dialog>

	<dialog id="puzzle-settings">
		<div class="dlg-title">
			<h1>Settings</h1>
		</div>
		<div class="dlg-row dlg-row-justify-left">
			<div class="dlg-row dlg-row-space-between">
			<label class="checkbox-label" for="ShowErrors"><input type="checkbox" name="ShowErrors" id="ShowErrors" data-prop-name="showErrors"/>Show errors</label><div class="puzzle-cell puzzle-cell-sample" cluenumber="23"></div>
			</div>
			<div class="dlg-row-description">Show incorrect letters and show where errors were corrected.</div>
		</div>
		<div class="dlg-row dlg-row-justify-left">
			<label class="checkbox-label" for="SkipFilled"><input type="checkbox" name="SkipFilled" id="SkipFilled" data-prop-name="skipFilledCells" />Skip filled boxes</label>
			<div class="dlg-row-description">Skip over boxes that are already filled in.</div>
		</div>
		<div class="dlg-row dlg-row-justify-left">
			<label for="MovementStyle">Movement style</label>
			<select name="MovementStyle" id="MovementStyle" data-prop-name="movementStyle">
				<option value="nextWordInLine">Next word in line</option>
				<option value="stopAtEnd">Stop at the end</option>
				<option value="nextClueInSameDirection">Next clue in same direction</option>
				<option value="nextParallelClue">Next parallel clue</option>
			</select>
			<div class="dlg-row-description">Select what happens when you type past the end of a word.</div>
		</div>
		<div class="dlg-footer">
			<button class="close-btn" action="close-dlg">Close</button>
		</div>
	</dialog>
</body>

</html>
